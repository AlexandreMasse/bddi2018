webpackJsonp([0],[,function(e,t,i){"use strict";(function(e){function n(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(11),r=(n(o),i(8)),h=n(r),c=i(5),u=n(c),l=i(9),d=n(l),f=i(6),m=n(f),v=i(7),y=n(v),w=i(10),p=n(w),g=i(4),k=n(g),M=function(){function t(){s(this,t),this.container=document.querySelector("#main"),document.body.appendChild(this.container),this.loading=document.querySelector(".loading"),this.growLimit=1.5,this.shrinkLimit=1,this.currentMountain=0,this.targetCameraIntroPos={x:50,y:35,z:60},this.camera=new e.PerspectiveCamera(40,window.innerWidth/window.innerHeight,.1,200),this.camera.position.set(90,75,100),this.scene=new e.Scene,this.scene.background=new e.Color(9364950);var i={0:{radius:7,height:15,posY:7,posX:-25,posZ:-20},1:{radius:6,height:12,posY:5,posX:-27,posZ:-15},2:{radius:6,height:13,posY:5.5,posX:-20,posZ:-20},3:{radius:5,height:15,posY:6.5,posX:-27,posZ:-25},4:{radius:4,height:9,posY:4,posX:-25,posZ:-25},5:{radius:5,height:11,posY:5,posX:-19,posZ:-23}};this.createMountains(5,i),this.createFloor(),this.createLights(),this.createSnowmen(5),this.createTrees(100),this.createSnow(200),this.createIgloo(),this.createLake(),this.handleAudio(),this.renderer=new e.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.container.appendChild(this.renderer.domElement);var n=new e.OrbitControls(this.camera,this.renderer.domElement);n.enableZoom=!1,n.enableRotate=!1,window.addEventListener("resize",this.onWindowResize.bind(this),!1),this.onWindowResize(),window.scene=this.scene,window.THREE=e,this.renderer.animate(this.render.bind(this)),this.eventListeners()}return a(t,[{key:"cameraMove",value:function(){this.camera.position.x-=.25,this.camera.position.z-=.25,this.camera.position.y-=.25}},{key:"eventListeners",value:function(){var e=this,t=document.querySelector(".pauseBtn");t.addEventListener("click",function(){t.classList.contains("flaticon-pause-symbol")?(e.audio.pause(),t.classList.remove("flaticon-pause-symbol"),t.classList.toggle("flaticon-play-button")):(e.audio.play(),t.classList.remove("flaticon-play-button"),t.classList.toggle("flaticon-pause-symbol"))})}},{key:"startExp",value:function(){var e=this,t=document.querySelector(".startBtn");t.innerHTML="Start the experiment",t.classList.add("show"),t.addEventListener("click",function(){e.started=!0,e.audio.play(),document.getElementById("introScreen").classList.add("hidden")})}},{key:"handleAudio",value:function(){var e=this;this.audio=new k.default(p.default,126,3,function(){e.startExp()},!1),this.kick=this.audio.createKick({frequency:[0,3],decay:.5,threshold:.5,onKick:function(){e.growMountains()},offKick:function(){e.shrinkMountains()}}),this.kick.on()}},{key:"getAverageFrequency",value:function(e){for(var t=this.audio.getSpectrum().slice(0,200),i=[],n=e||1,s=0,a=0,o=Math.floor(t.length/n),r=o,h=0;h<n;h++){for(a;a<o;a++)s+=t[a];i.push(s/r),o+=r,a+=1,s=0}return i}},{key:"createIgloo",value:function(){var t=(new e.TextureLoader).load(u.default),i=new e.SphereGeometry(5,32,32,Math.PI,Math.PI,Math.PI),n=new e.MeshBasicMaterial({color:14876669,side:e.DoubleSide,map:t}),s=new e.Mesh(i,n);s.rotation.set(20.5,22,-.65),s.position.set(12.5,.2,15),this.scene.add(s)}},{key:"createLake",value:function(){var t=new e.CircleGeometry(3,15,2),i=new e.MeshBasicMaterial({color:974588}),n=new e.Mesh(t,i);n.position.set(20,-17,.2),this.floorMesh.add(n),t=new e.CircleGeometry(3.5,15,2),i=new e.MeshBasicMaterial({color:974588});var s=new e.Mesh(t,i);n.add(s),s.position.set(2,2,0)}},{key:"createTrees",value:function(t){this.trees=[];for(var i=0;i<t+1;i++){var n=1*Math.random()-.8+1,s=4*Math.random()-1+4,a=Math.random()*Math.PI*2,o=Math.random()>0?1:-1,r=Math.cos(a)*(28*Math.random()-.05)*o,h=-(25*Math.random()-.05),c=new e.ConeGeometry(n,s,20),u=new e.MeshPhongMaterial({emissive:603700});r=r<-15?-1*r:r,h=h>12?-1*h:h;var l=new e.Mesh(c,u);l.position.set(r,s/1.5,h),this.scene.add(l);var d=new e.ConeGeometry(n-.05,s-.8,20),f=new e.Mesh(d,u);f.position.y=-1.5,l.add(f)}}},{key:"createSnow",value:function(t){this.particles=[];for(var i=new e.TextureLoader,n=i.load(m.default),s=i.load(y.default),a=new e.Geometry,o=0;o<t;o++){var r=new e.Vector3;r.x=180*Math.random()-80,r.y=180*Math.random()-80,r.z=180*Math.random()-80,a.vertices.push(r)}for(var h=[[n,3],[s,1],[n,3.5],[s,2]],c=0;c<h.length;c++){var u=h[c][0],l=h[c][1],d=[];d[c]=new e.PointsMaterial({size:l,map:u,blending:e.AdditiveBlending,depthTest:!1,transparent:!0});var f=new e.Points(a,d[c]);this.particles.push(f),f.rotation.x=6*Math.random(),f.rotation.y=6*Math.random(),f.rotation.z=6*Math.random(),this.scene.add(f)}}},{key:"createSnowmen",value:function(t){this.snowmens=[];for(var i=(new e.TextureLoader).load(d.default),n=0;n<t;n++){var s=new e.Group;s.position.set(3*n-2,3,15-3*n);var a=new e.SphereGeometry(1.3,2*Math.PI,50,0,2*Math.PI),o=new e.MeshLambertMaterial({emissive:13364988,emissiveIntensity:1.1,color:13102823}),r=new e.Mesh(a,o),h=new e.SphereGeometry(1.7,2*Math.PI,50,0,2*Math.PI),c=new e.Mesh(h,o);c.position.y=-2,r.add(c);for(var u=new e.MeshLambertMaterial({emissive:0}),l=.7,f=1.1,m=0;m<=1;m++){var v=new e.SphereGeometry(.1,2*Math.PI,50,0,2*Math.PI),y=new e.Mesh(v,u);y.position.set(l,.3,f),r.add(y),l+=.4,f-=.5,s.add(y)}for(var w=-.5,p=0;p<=1;p++){var g=new e.SphereGeometry(.1,2*Math.PI,50,0,2*Math.PI),k=new e.Mesh(g,u);k.position.set(1.25,w,.8),s.add(k),c.add(k),w+=.5}for(var M=-.6,x=1.5,b=Math.PI/5,_=0;_<2;_++){var P=new e.CylinderGeometry(.05,.05,2,32),T=new e.MeshPhongMaterial({emissive:6041872}),L=new e.Mesh(P,T);L.position.set(M,-2,x),L.rotation.x=b,c.add(L),M*=-1,x*=-1,b*=-1,s.add(L)}var q=new e.ConeGeometry(.2,.8,20),A=new e.MeshPhongMaterial({emissive:15236682}),S=new e.Mesh(q,A);S.position.set(1,0,.9),S.rotation.set(1.5,0,-Math.PI/4),r.add(S);var B=new e.TorusGeometry(1.2,.25,8,100,6.3),I=new e.MeshBasicMaterial({map:i}),K=new e.Mesh(B,I);K.position.y=-.85,K.rotation.x=Math.PI/2,r.add(K);var C=new e.BoxGeometry(.25,.5,1.25),E=new e.Mesh(C,I);K.add(E),E.position.set(1.5,-1.5,.6),E.rotation.set(Math.PI/2,Math.PI/6,Math.PI/3),s.add(r,c,K,S,E),this.snowmens.push(s),this.scene.add(s)}}},{key:"createMountains",value:function(t,i){this.mountains=[],this.mountainsTexture=(new e.TextureLoader).load(h.default);for(var n=0;n<4;n++){for(var s=new e.Group,a=0;a<6;a++){var o=i[a],r=new e.ConeGeometry(o.radius,o.height,20),c=new e.MeshPhongMaterial({map:this.mountainsTexture,emissive:9542305}),u=new e.Mesh(r,c);s.add(u),u.position.y=o.posY,u.position.x=o.posX,u.position.z=o.posZ+10*n}this.mountains.push(s),this.scene.add(s)}}},{key:"createLights",value:function(){this.smallLight=new e.PointLight(16777215,.2),this.smallLight.position.set(5,30,-15),this.scene.add(this.smallLight)}},{key:"createFloor",value:function(){var t=(new e.TextureLoader).load(t),i=new e.PlaneGeometry(60,55,25,25),n=new e.BoxGeometry(60,2,55),s=new e.MeshPhongMaterial({color:14021375,emissive:10348779}),a=new e.MeshPhongMaterial({color:671553,emissive:14021375});this.floorMesh=new e.Mesh(i,a),this.floorBoxMesh=new e.Mesh(n,s),this.floorMesh.rotation.x=-Math.PI/2,this.floorBoxMesh.position.y=-1.15,this.scene.add(this.floorMesh,this.floorBoxMesh)}},{key:"growMountains",value:function(){var e=this.mountains.length-1,t=this.currentMountain;if(this.currentMountain<=e){var i=this.mountains[this.currentMountain];i.scale.y<this.growLimit&&(i.scale.y+=.1,this.currentMountain+=1),t==e&&(this.currentMountain=0)}}},{key:"shrinkMountains",value:function(){for(var e=0;e<this.mountains.length;e++){var t=this.mountains[e];t.scale.y>this.shrinkLimit&&(t.scale.y-=.001)}}},{key:"animateSnow",value:function(){for(var e=5e-5*Date.now(),t=this.getAverageFrequency()[0],i=0;i<this.particles.length;i++)this.particles[i].rotation.y=t>0?e*(i<4?i+1:-(i+1))*t*5e-11:e*(i<4?i+1:-(i+1))}},{key:"animateSnowmen",value:function(){for(var e=0;e<this.snowmens.length;e++)this.snowmens[e].rotation.y+=5e-4*this.getAverageFrequency(this.snowmens.length)[e]}},{key:"render",value:function(){1==this.started?(this.camera.position.y>this.targetCameraIntroPos.y&&this.cameraMove(),this.animateSnow(),this.getAverageFrequency()[0]>60&&this.animateSnowmen(),this.renderer.render(this.scene,this.camera)):this.loading.innerHTML=Math.floor(100*this.audio.progress)+"%"}},{key:"onWindowResize",value:function(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}}]),t}();t.default=M}).call(t,i(0))},function(e,t){},function(e,t,i){"use strict";i(2);var n=i(1),s=function(e){return e&&e.__esModule?e:{default:e}}(n);window.app=new s.default},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=function(){function e(t,i,s,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n(this,e),this.ctx;try{window.AudioContext=window.AudioContext||window.webkitAudioContext,this.ctx=new AudioContext}catch(e){throw new Error("Web Audio API is not supported in this browser")}this._bpm=i,this._beatDuration=60/this._bpm,this._offsetTime=s,this._sections=[],this._kicks=[],this._beats=[],this._startTime=0,this._pauseTime=0,this._isPlaying=!1,this._isLoaded=!1,this._progress=0,this._onUpdate=this.onUpdate.bind(this),this._onEnded=this.onEnded.bind(this),this.gainNode=this.ctx.createGain(),this.gainNode.connect(this.ctx.destination),this.analyserNode=this.ctx.createAnalyser(),this.analyserNode.connect(this.gainNode),this.analyserNode.smoothingTimeConstant=.8,this.analyserNode.fftSize=512;var r=this.analyserNode.frequencyBinCount;this.frequencyDataArray=new Uint8Array(r),this.timeDomainDataArray=new Uint8Array(r),o&&(this.debug=new h(this)),this._load(t,a),window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame}return s(e,[{key:"_load",value:function(e,t){var i=this;if(e){this._isLoaded=!1,this._progress=0;var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onprogress=function(e){i._progress=e.loaded/e.total},n.onload=function(){i.ctx.decodeAudioData(n.response,function(e){i._buffer=e,i._isLoaded=!0,t&&t()},function(e){console.log(e)})},n.send()}}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.req&&cancelAnimationFrame(this.req),this._onUpdate(),this._isPlaying=!0;var t=this._pauseTime-this._startTime+e;this._startTime=this.ctx.currentTime-t,this.sourceNode=this.ctx.createBufferSource(),this.sourceNode.connect(this.analyserNode),this.sourceNode.buffer=this._buffer,this.sourceNode.start(0,t),this.sourceNode.addEventListener("ended",this._onEnded,!1)}},{key:"pause",value:function(){this.req&&cancelAnimationFrame(this.req),this.sourceNode&&(this.sourceNode.removeEventListener("ended",this._onEnded,!1),this.sourceNode.stop(0),this.sourceNode.disconnect(),this.sourceNode=null),this._pauseTime=this.ctx.currentTime,this._isPlaying=!1}},{key:"before",value:function(e,t,i){var n=this;return this._sections.push({label:e,condition:function(){return n.time<t},callback:i}),this}},{key:"after",value:function(e,t,i){var n=this;return this._sections.push({label:e,condition:function(){return n.time>t},callback:i}),this}},{key:"between",value:function(e,t,i,n){var s=this;return this._sections.push({label:e,condition:function(){return s.time>t&&s.time<i},callback:n}),this}},{key:"onceAt",value:function(e,t,i){var n=this,s=null;return this._sections.push({label:e,condition:function(){return n.time>t&&!this.called},callback:function(){console.log("once :",s.label),i.call(this),s.called=!0},called:!1}),s=this._sections[this._sections.length-1],this}},{key:"getSpectrum",value:function(){return this.analyserNode.getByteFrequencyData(this.frequencyDataArray),this.frequencyDataArray}},{key:"getWaveform",value:function(){return this.analyserNode.getByteTimeDomainData(this.timeDomainDataArray),this.timeDomainDataArray}},{key:"getFrequency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=0,n=this.getSpectrum();if(void 0!==t){for(var s=e;s<=t;s++)i+=n[s];return i/(t-e+1)}return n[e]}},{key:"createKick",value:function(e){var t=e.frequency,i=e.threshold,n=e.decay,s=e.onKick,a=e.offKick,r=new o({frequency:t,threshold:i,decay:n,onKick:s,offKick:a});return this._kicks.push(r),r}},{key:"createBeat",value:function(e){var t=e.factor,i=e.onBeat,n=new r({factor:t,onBeat:i});return this._beats.push(n),n}},{key:"onUpdate",value:function(){this.req=requestAnimationFrame(this._onUpdate);for(var e in this._sections)this._sections[e].condition()&&this._sections[e].callback.call(this);var t=this.getSpectrum();for(var i in this._kicks)this._kicks[i].calc(t);var n=Math.max(0,this.time-this._offsetTime);for(var s in this._beats)this._beats[s].calc(n,this._beatDuration);this.debug&&this.debug.draw()}},{key:"onEnded",value:function(){this.stop()}},{key:"progress",get:function(){return this._progress}},{key:"isLoaded",get:function(){return this._isLoaded}},{key:"duration",get:function(){return this._isLoaded?this._buffer.duration:0}},{key:"time",get:function(){return this.isPlaying?this.ctx.currentTime-this._startTime:this._pauseTime-this._startTime}},{key:"volume",set:function(e){this.gainNode.gain.value=e},get:function(){return this.gainNode.gain.value}},{key:"isPlaying",get:function(){return this._isPlaying}},{key:"beatDuration",get:function(){return this._beatDuration}}]),e}();t.default=a;var o=function(){function e(t){var i=t.frequency,s=t.threshold,a=t.decay,o=t.onKick,r=t.offKick;n(this,e),this.frequency=void 0!==i?i:[0,10],this.threshold=void 0!==s?s:.3,this.decay=void 0!==a?a:.02,this.onKick=o,this.offKick=r,this.isOn=!1,this.isKick=!1,this.currentThreshold=this.threshold}return s(e,[{key:"on",value:function(){this.isOn=!0}},{key:"off",value:function(){this.isOn=!1}},{key:"set",value:function(e){var t=e.frequency,i=e.threshold,n=e.decay,s=e.onKick,a=e.offKick;this.frequency=void 0!==t?t:this.frequency,this.threshold=void 0!==i?i:this.threshold,this.decay=void 0!==n?n:this.decay,this.onKick=s||this.onKick,this.offKick=a||this.offKick}},{key:"calc",value:function(e){if(this.isOn){var t=this.maxAmplitude(e,this.frequency);t>=this.currentThreshold&&t>=this.threshold?(this.currentThreshold=t,this.onKick&&this.onKick(t),this.isKick=!0):(this.offKick&&this.offKick(t),this.currentThreshold-=this.decay,this.isKick=!1)}}},{key:"maxAmplitude",value:function(e,t){var i=0;if(!t.length)return t<e.length?e[~~t]:null;for(var n=t[0],s=t[1];n<=s;n++)e[n]>i&&(i=e[n]);return i}}]),e}(),r=function(){function e(t){var i=t.factor,s=t.onBeat;n(this,e),this.factor=void 0!==i?i:1,this.onBeat=s,this.isOn=!1,this.currentTime=0}return s(e,[{key:"on",value:function(){this.isOn=!0}},{key:"off",value:function(){this.isOn=!1}},{key:"set",value:function(e){var t=e.factor,i=e.onBeat;this.factor=void 0!==t?t:this.factor,this.onBeat=i||this.onBeat}},{key:"calc",value:function(e,t){if(0!=e){var i=t*this.factor;e>=this.currentTime+i&&(this.isOn&&this.onBeat&&this.onBeat(),this.currentTime+=i)}}}]),e}(),h=function(){function e(t){n(this,e),this.sound=t,this.canvas=document.createElement("canvas"),this.canvas.width=512,this.canvas.height=300,this.canvas.style.position="absolute",this.canvas.style.bottom=0,this.canvas.style.left=0,this.canvas.style.zIndex=3,document.body.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),window.addEventListener("resize",this.resize.bind(this),!1),this.resize()}return s(e,[{key:"resize",value:function(){this.canvas.width=window.innerWidth}},{key:"draw",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.beginPath(),this.ctx.rect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#000000",this.ctx.fill(),this.ctx.strokeStyle="#a1a1a1",this.ctx.stroke(),this.ctx.beginPath();for(var e=this.sound.getSpectrum(),t=null,i=e.length,n=this.canvas.width/i,s=this.canvas.height-10,a=0;a<i;a++)t=e[a]/256,this.ctx.rect(a*n,s-s*t,n/2,s*t);this.ctx.fillStyle="#ffffff",this.ctx.fill(),this.ctx.beginPath(),this.ctx.font="10px Arial",this.ctx.textBaseline="middle",this.ctx.textAlign="left";for(var o=0,r=i;o<r;o++)o%10==0&&(this.ctx.rect(o*n,s,n/2,10),this.ctx.fillText(o,o*n+4,s+5));this.ctx.fillStyle="#ffffff",this.ctx.fill();for(var h=this.sound._kicks,c=null,u=h.length,l=null,d=null,f=0,m=u;f<m;f++)c=h[f],c.isOn&&(l=c.frequency.length?c.frequency[0]:c.frequency,d=c.frequency.length?c.frequency[1]-c.frequency[0]+1:1,this.ctx.beginPath(),this.ctx.rect(l*n,s-s*(c.threshold/256),d*n-.5*n,2),this.ctx.rect(l*n,s-s*(c.currentThreshold/256),d*n-.5*n,5),this.ctx.fillStyle=c.isKick?"#00ff00":"#ff0000",this.ctx.fill());this.ctx.beginPath();for(var v=this.sound.getWaveform(),y=null,w=v.length,p=this.canvas.width/w,g=this.canvas.height-10,k=0;k<w;k++)y=v[k]/256,0==k?this.ctx.moveTo(k*p,g*y):this.ctx.lineTo(k*p,g*y);this.ctx.strokeStyle="#0000ff",this.ctx.stroke(),this.ctx.beginPath(),this.ctx.textAlign="right",this.ctx.textBaseline="top",this.ctx.font="15px Arial",this.ctx.fillStyle="#ffffff",this.ctx.fillText(Math.round(10*this.sound.time)/10+" / "+Math.round(10*this.sound.duration)/10,this.canvas.width-5,5),this.ctx.beginPath();for(var M=this.sound._sections,x=null,b=M.length,_="",P=0,T=b;P<T;P++)x=M[P],x.condition()&&(_+=x.label+" - ");_.length>0&&(_=_.substr(0,_.length-3)),this.ctx.fillText(_,this.canvas.width-5,25),this.ctx.fill()}}]),e}()},function(e,t,i){e.exports=i.p+"assets/img/igloo.3c958126b0d1cf52667c012714fb9ed6.jpg"},function(e,t,i){e.exports=i.p+"assets/img/snowFlake1.e5feddcbe62f05fa4f7b75b96cc8f75d.png"},function(e,t,i){e.exports=i.p+"assets/img/snowFlake2.f603d74a971df064b22396233b275c0c.png"},function(e,t,i){e.exports=i.p+"assets/img/snowMountains.8279f0706bd663b158e4b1b65ab70383.jpg"},function(e,t,i){e.exports=i.p+"assets/img/stripes.5c26234e2007918bf26d588819f4922a.jpg"},function(e,t,i){e.exports=i.p+"assets/sounds/sound.0314d1b73e0b50b119f67ab918283875.mp3"}],[3]);