webpackJsonp([0],[,,function(t,e,n){"use strict";(function(t){function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(14),r=(i(a),n(8)),c=i(r),h=n(13),u=i(h),l=n(11),d=i(l),p=n(9),m=i(p),f=n(10),g=i(f),y=function(){function e(){var n=this;o(this,e),this.snoise=new u.default,this.clock=new t.Clock,this.delta=0,this.time=0,this.maxSpeed=0,this.firstColor=new t.Color(16382457),this.secondColor=new t.Color(262148),this.container=document.querySelector("#main"),document.body.appendChild(this.container),this.camera=new t.PerspectiveCamera(70,window.innerWidth/window.innerHeight,.1,appConfig.far),this.debugCamera=appConfig.debugCamera,this.cameraLookAt=new t.Vector3(0,0,0),this.cameraPos=function(){appConfig.debugCamera?(n.camera.position.z=-10,n.camera.position.y=20,n.camera.position.x=90,n.camera.lookAt(new t.Vector3(0,0,0))):(n.camera.position.z=appConfig.camPosX,n.camera.position.y=appConfig.camPosY,n.camera.position.x=appConfig.camPosZ,n.camera.rotation.copy(new t.Euler(.3,0,0,"XYZ")))},this.cameraPos(),this.scene=new t.Scene,this.scene.background=this.firstColor,this.scene.fog=new t.Fog(this.firstColor,1,appConfig.far),this.ground=new g.default({app:this}),this.rain=new d.default({app:this}),this.columns=new m.default({app:this}),this.addLights(),this.renderer=new t.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.container.appendChild(this.renderer.domElement),window.addEventListener("resize",this.onWindowResize.bind(this),!1),this.onWindowResize(),this.renderer.animate(this.render.bind(this)),this.clock.start(),this.processAudio(),appConfig.gui&&this.addGui()}return s(e,[{key:"render",value:function(){this.delta=this.clock.getDelta(),this.time=this.clock.getElapsedTime(),this.maxSpeed+=appConfig.moverSpeed*this.delta,this.maxSpeed=Math.min(this.maxSpeed,appConfig.maxFinalSpeed),TWEEN.update(),this.ground.animate(),this.rain.animate(),this.columns.animate(),this.renderer.render(this.scene,this.camera)}},{key:"onWindowResize",value:function(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}},{key:"addLights",value:function(){this.spotLight=new t.SpotLight(0),this.spotLight.intensity=appConfig.spotLightIntensity,this.spotLight.angle=Math.PI/2,this.spotLight.position.set(0,20,10),this.spotLight.castShadow=!0,this.spotLight.shadow.mapSize.width=1024,this.spotLight.shadow.mapSize.height=2048,this.spotLight.shadow.camera.near=500,this.spotLight.shadow.camera.far=4e3,this.spotLight.shadow.camera.fov=30,this.spotLight.target.position.set(0,0,-80),this.scene.add(this.spotLight.target),this.scene.add(this.spotLight),this.directionalLight=new t.DirectionalLight(16777215,appConfig.directionalLightIntensity),this.scene.add(this.directionalLight)}},{key:"changeScenePos",value:function(){appConfig.columns.isChanging||appConfig.columns.changedFirstPos||(this.columns.changePosition(),appConfig.columns.changedFirstPos=!0)}},{key:"processAudio",value:function(){var t=this,e=function(){var e=document.getElementById("intro"),n=document.getElementById("load-button");n.classList.add("active"),n.addEventListener("click",function(n){n.preventDefault(),e.classList.add("hide"),t.sound.play(),appConfig.moverSpeed=appConfig.minSpeed},!1)};this.sound=new c.default("lorn-anvil.mp3",100,0,e,!1),this.kick=this.sound.createKick({frequency:[60,70],decay:1.2,threshold:135,onKick:function(){t.kick.lastKick&&Date.now()-t.kick.lastKick>800&&(t.columns.randSpawn(),t.kick.lastKick=Date.now())}}),this.kick.lastKick=Date.now(),this.kick.on(),this.highKick=this.sound.createKick({frequency:[60,70],decay:.1,threshold:180,onKick:function(){t.highKick.lastKick&&Date.now()-t.highKick.lastKick>1e3&&(tools.isOdd(t.highKick.count)?t.switchColors(t.secondColor,t.firstColor):t.switchColors(t.firstColor,t.secondColor),t.highKick.lastKick=Date.now(),t.highKick.count++)}}),this.highKick.count=1,this.highKick.lastKick=Date.now(),this.highKick.on(),this.nbSoundActs=5,this.soundActChange=[];for(var n=this.nbSoundActs;n--;)this.soundActChange[n]=!1;this.sound.after("firstPos",17,function(){appConfig.columns.isChanging||t.soundActChange[0]||(t.columns.changePosition(),appConfig.columns.changedFirstPos=!0,t.soundActChange[0]=!0)}),this.sound.after("secondPos",36,function(){appConfig.columns.isChanging||t.soundActChange[1]||(t.columns.changePosition(),t.soundActChange[1]=!0)}),this.sound.after("thirdPos",80,function(){appConfig.columns.isChanging||t.soundActChange[2]||(t.columns.changePosition(),t.soundActChange[2]=!0)}),this.sound.after("forthPos",114,function(){appConfig.columns.isChanging||t.soundActChange[3]||(appConfig.columns.isChanging=!0,appConfig.columns.position="random",t.soundActChange[3]=!0)}),this.sound.after("lastPos",153,function(){appConfig.columns.isChanging||t.soundActChange[4]||(appConfig.columns.isChanging=!0,appConfig.columns.position="arc",t.soundActChange[4]=!0)})}},{key:"switchColors",value:function(t,e){this.scene.background=e,this.scene.fog.color=e,this.ground.ground.material.color=t,this.ground.ground.material.emissive=t,this.columns.material.color=e,this.columns.material.color=e,this.columns.outlineMaterial1.color=t}}]),e}();e.default=y}).call(e,n(0))},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=function(){function t(){i(this,t)}return o(t,[{key:"de2ra",value:function(t){return t*(Math.PI/180)}},{key:"isOdd",value:function(t){return t%2}},{key:"easeOutQuad",value:function(t,e,n,i){return t/=i,-n*t*(t-2)+e}}]),t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={gui:!1,rainSpeed:1.5,moverSpeed:0,minSpeed:.07,maxFinalSpeed:1.1,spotLightIntensity:.68,directionalLightIntensity:.23,noiseTextureSize:50,orbitControl:!1,debugCamera:!1,far:450,camPosX:0,camPosY:4,camPosZ:0,camLookAtX:0,camLookAtY:0,camLookAtZ:0,columns:{speed:2,arc:!0,toArc:!1,isChanging:!1,changedFirstPos:!1,changedSecondPos:!1,positions:["lane","arc","random"],position:"lane"}}},function(t,e,n){"use strict";(function(t){t.OrbitControls=function(e,n){function i(){return 2*Math.PI/60/60*z.autoRotateSpeed}function o(){return Math.pow(.95,z.zoomSpeed)}function s(t){H.theta-=t}function a(t){H.phi-=t}function r(e){z.object instanceof t.PerspectiveCamera?G/=e:z.object instanceof t.OrthographicCamera?(z.object.zoom=Math.max(z.minZoom,Math.min(z.maxZoom,z.object.zoom*e)),z.object.updateProjectionMatrix(),B=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),z.enableZoom=!1)}function c(e){z.object instanceof t.PerspectiveCamera?G*=e:z.object instanceof t.OrthographicCamera?(z.object.zoom=Math.max(z.minZoom,Math.min(z.maxZoom,z.object.zoom/e)),z.object.updateProjectionMatrix(),B=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),z.enableZoom=!1)}function h(t){V.set(t.clientX,t.clientY)}function u(t){J.set(t.clientX,t.clientY)}function l(t){Z.set(t.clientX,t.clientY)}function d(t){W.set(t.clientX,t.clientY),Y.subVectors(W,V);var e=z.domElement===document?z.domElement.body:z.domElement;s(2*Math.PI*Y.x/e.clientWidth*z.rotateSpeed),a(2*Math.PI*Y.y/e.clientHeight*z.rotateSpeed),V.copy(W),z.update()}function p(t){$.set(t.clientX,t.clientY),tt.subVectors($,J),tt.y>0?r(o()):tt.y<0&&c(o()),J.copy($),z.update()}function m(t){X.set(t.clientX,t.clientY),Q.subVectors(X,Z),it(Q.x,Q.y),Z.copy(X),z.update()}function f(t){}function g(t){t.deltaY<0?c(o()):t.deltaY>0&&r(o()),z.update()}function y(t){switch(t.keyCode){case z.keys.UP:it(0,z.keyPanSpeed),z.update();break;case z.keys.BOTTOM:it(0,-z.keyPanSpeed),z.update();break;case z.keys.LEFT:it(z.keyPanSpeed,0),z.update();break;case z.keys.RIGHT:it(-z.keyPanSpeed,0),z.update()}}function v(t){V.set(t.touches[0].pageX,t.touches[0].pageY)}function b(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);J.set(0,i)}function w(t){Z.set(t.touches[0].pageX,t.touches[0].pageY)}function k(t){W.set(t.touches[0].pageX,t.touches[0].pageY),Y.subVectors(W,V);var e=z.domElement===document?z.domElement.body:z.domElement;s(2*Math.PI*Y.x/e.clientWidth*z.rotateSpeed),a(2*Math.PI*Y.y/e.clientHeight*z.rotateSpeed),V.copy(W),z.update()}function C(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);$.set(0,i),tt.subVectors($,J),tt.y>0?c(o()):tt.y<0&&r(o()),J.copy($),z.update()}function E(t){X.set(t.touches[0].pageX,t.touches[0].pageY),Q.subVectors(X,Z),it(Q.x,Q.y),Z.copy(X),z.update()}function x(t){}function P(t){if(!1!==z.enabled){switch(t.preventDefault(),t.button){case z.mouseButtons.ORBIT:if(!1===z.enableRotate)return;h(t),q=K.ROTATE;break;case z.mouseButtons.ZOOM:if(!1===z.enableZoom)return;u(t),q=K.DOLLY;break;case z.mouseButtons.PAN:if(!1===z.enablePan)return;l(t),q=K.PAN}q!==K.NONE&&(document.addEventListener("mousemove",A,!1),document.addEventListener("mouseup",O,!1),z.dispatchEvent(D))}}function A(t){if(!1!==z.enabled)switch(t.preventDefault(),q){case K.ROTATE:if(!1===z.enableRotate)return;d(t);break;case K.DOLLY:if(!1===z.enableZoom)return;p(t);break;case K.PAN:if(!1===z.enablePan)return;m(t)}}function O(t){!1!==z.enabled&&(f(t),document.removeEventListener("mousemove",A,!1),document.removeEventListener("mouseup",O,!1),z.dispatchEvent(j),q=K.NONE)}function S(t){!1===z.enabled||!1===z.enableZoom||q!==K.NONE&&q!==K.ROTATE||(t.preventDefault(),t.stopPropagation(),g(t),z.dispatchEvent(D),z.dispatchEvent(j))}function T(t){!1!==z.enabled&&!1!==z.enableKeys&&!1!==z.enablePan&&y(t)}function _(t){if(!1!==z.enabled){switch(t.touches.length){case 1:if(!1===z.enableRotate)return;v(t),q=K.TOUCH_ROTATE;break;case 2:if(!1===z.enableZoom)return;b(t),q=K.TOUCH_DOLLY;break;case 3:if(!1===z.enablePan)return;w(t),q=K.TOUCH_PAN;break;default:q=K.NONE}q!==K.NONE&&z.dispatchEvent(D)}}function L(t){if(!1!==z.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(!1===z.enableRotate)return;if(q!==K.TOUCH_ROTATE)return;k(t);break;case 2:if(!1===z.enableZoom)return;if(q!==K.TOUCH_DOLLY)return;C(t);break;case 3:if(!1===z.enablePan)return;if(q!==K.TOUCH_PAN)return;E(t);break;default:q=K.NONE}}function M(t){!1!==z.enabled&&(x(t),z.dispatchEvent(j),q=K.NONE)}function R(t){!1!==z.enabled&&t.preventDefault()}this.object=e,this.domElement=void 0!==n?n:document,this.enabled=!0,this.target=new t.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:t.MOUSE.LEFT,ZOOM:t.MOUSE.MIDDLE,PAN:t.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return I.phi},this.getAzimuthalAngle=function(){return I.theta},this.saveState=function(){z.target0.copy(z.target),z.position0.copy(z.object.position),z.zoom0=z.object.zoom},this.reset=function(){z.target.copy(z.target0),z.object.position.copy(z.position0),z.object.zoom=z.zoom0,z.object.updateProjectionMatrix(),z.dispatchEvent(N),z.update(),q=K.NONE},this.update=function(){var n=new t.Vector3,o=(new t.Quaternion).setFromUnitVectors(e.up,new t.Vector3(0,1,0)),a=o.clone().inverse(),r=new t.Vector3,c=new t.Quaternion;return function(){var t=z.object.position;return n.copy(t).sub(z.target),n.applyQuaternion(o),I.setFromVector3(n),z.autoRotate&&q===K.NONE&&s(i()),I.theta+=H.theta,I.phi+=H.phi,I.theta=Math.max(z.minAzimuthAngle,Math.min(z.maxAzimuthAngle,I.theta)),I.phi=Math.max(z.minPolarAngle,Math.min(z.maxPolarAngle,I.phi)),I.makeSafe(),I.radius*=G,I.radius=Math.max(z.minDistance,Math.min(z.maxDistance,I.radius)),z.target.add(U),n.setFromSpherical(I),n.applyQuaternion(a),t.copy(z.target).add(n),z.object.lookAt(z.target),!0===z.enableDamping?(H.theta*=1-z.dampingFactor,H.phi*=1-z.dampingFactor):H.set(0,0,0),G=1,U.set(0,0,0),!!(B||r.distanceToSquared(z.object.position)>F||8*(1-c.dot(z.object.quaternion))>F)&&(z.dispatchEvent(N),r.copy(z.object.position),c.copy(z.object.quaternion),B=!1,!0)}}(),this.dispose=function(){z.domElement.removeEventListener("contextmenu",R,!1),z.domElement.removeEventListener("mousedown",P,!1),z.domElement.removeEventListener("wheel",S,!1),z.domElement.removeEventListener("touchstart",_,!1),z.domElement.removeEventListener("touchend",M,!1),z.domElement.removeEventListener("touchmove",L,!1),document.removeEventListener("mousemove",A,!1),document.removeEventListener("mouseup",O,!1),window.removeEventListener("keydown",T,!1)};var z=this,N={type:"change"},D={type:"start"},j={type:"end"},K={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},q=K.NONE,F=1e-6,I=new t.Spherical,H=new t.Spherical,G=1,U=new t.Vector3,B=!1,V=new t.Vector2,W=new t.Vector2,Y=new t.Vector2,Z=new t.Vector2,X=new t.Vector2,Q=new t.Vector2,J=new t.Vector2,$=new t.Vector2,tt=new t.Vector2,et=function(){var e=new t.Vector3;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),U.add(e)}}(),nt=function(){var e=new t.Vector3;return function(t,n){e.setFromMatrixColumn(n,1),e.multiplyScalar(t),U.add(e)}}(),it=function(){var e=new t.Vector3;return function(n,i){var o=z.domElement===document?z.domElement.body:z.domElement;if(z.object instanceof t.PerspectiveCamera){var s=z.object.position;e.copy(s).sub(z.target);var a=e.length();a*=Math.tan(z.object.fov/2*Math.PI/180),et(2*n*a/o.clientHeight,z.object.matrix),nt(2*i*a/o.clientHeight,z.object.matrix)}else z.object instanceof t.OrthographicCamera?(et(n*(z.object.right-z.object.left)/z.object.zoom/o.clientWidth,z.object.matrix),nt(i*(z.object.top-z.object.bottom)/z.object.zoom/o.clientHeight,z.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),z.enablePan=!1)}}();z.domElement.addEventListener("contextmenu",R,!1),z.domElement.addEventListener("mousedown",P,!1),z.domElement.addEventListener("wheel",S,!1),z.domElement.addEventListener("touchstart",_,!1),z.domElement.addEventListener("touchend",M,!1),z.domElement.addEventListener("touchmove",L,!1),window.addEventListener("keydown",T,!1),this.update()},t.OrbitControls.prototype=Object.create(t.EventDispatcher.prototype),t.OrbitControls.prototype.constructor=t.OrbitControls,Object.defineProperties(t.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(t){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!t}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(t){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!t}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(t){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!t}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(t){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!t}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(t){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!t}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(t){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=t}}})}).call(e,n(0))},function(t,e){},function(t,e,n){"use strict";(function(t){function e(t){return t&&t.__esModule?t:{default:t}}n(6);var i=n(4),o=e(i),s=n(5),a=(e(s),n(1)),r=e(a),c=n(3),h=e(c),u=n(2),l=e(u);window.appConfig=o.default,window.TWEEN=r.default,window.tools=new h.default,window.app=new l.default,window.scene=app.scene,window.THREE=t}).call(e,n(0))},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=function(){function t(e,n,o,s){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];i(this,t),this.ctx;try{window.AudioContext=window.AudioContext||window.webkitAudioContext,this.ctx=new AudioContext}catch(t){throw new Error("Web Audio API is not supported in this browser")}this._bpm=n,this._beatDuration=60/this._bpm,this._offsetTime=o,this._sections=[],this._kicks=[],this._beats=[],this._startTime=0,this._pauseTime=0,this._isPlaying=!1,this._isLoaded=!1,this._progress=0,this._onUpdate=this.onUpdate.bind(this),this._onEnded=this.onEnded.bind(this),this.gainNode=this.ctx.createGain(),this.gainNode.connect(this.ctx.destination),this.analyserNode=this.ctx.createAnalyser(),this.analyserNode.connect(this.gainNode),this.analyserNode.smoothingTimeConstant=.8,this.analyserNode.fftSize=512;var r=this.analyserNode.frequencyBinCount;this.frequencyDataArray=new Uint8Array(r),this.timeDomainDataArray=new Uint8Array(r),a&&(this.debug=new c(this)),this._load(e,s),window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame}return o(t,[{key:"_load",value:function(t,e){var n=this;if(t){this._isLoaded=!1,this._progress=0;var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onprogress=function(t){n._progress=t.loaded/t.total},i.onload=function(){n.ctx.decodeAudioData(i.response,function(t){n._buffer=t,n._isLoaded=!0,e&&e()},function(t){console.log(t)})},i.send()}}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.req&&cancelAnimationFrame(this.req),this._onUpdate(),this._isPlaying=!0;var e=this._pauseTime-this._startTime+t;this._startTime=this.ctx.currentTime-e,this.sourceNode=this.ctx.createBufferSource(),this.sourceNode.connect(this.analyserNode),this.sourceNode.buffer=this._buffer,this.sourceNode.start(0,e),this.sourceNode.addEventListener("ended",this._onEnded,!1)}},{key:"pause",value:function(){this.req&&cancelAnimationFrame(this.req),this.sourceNode&&(this.sourceNode.removeEventListener("ended",this._onEnded,!1),this.sourceNode.stop(0),this.sourceNode.disconnect(),this.sourceNode=null),this._pauseTime=this.ctx.currentTime,this._isPlaying=!1}},{key:"before",value:function(t,e,n){var i=this;return this._sections.push({label:t,condition:function(){return i.time<e},callback:n}),this}},{key:"after",value:function(t,e,n){var i=this;return this._sections.push({label:t,condition:function(){return i.time>e},callback:n}),this}},{key:"between",value:function(t,e,n,i){var o=this;return this._sections.push({label:t,condition:function(){return o.time>e&&o.time<n},callback:i}),this}},{key:"onceAt",value:function(t,e,n){var i=this,o=null;return this._sections.push({label:t,condition:function(){return i.time>e&&!this.called},callback:function(){console.log("once :",o.label),n.call(this),o.called=!0},called:!1}),o=this._sections[this._sections.length-1],this}},{key:"getSpectrum",value:function(){return this.analyserNode.getByteFrequencyData(this.frequencyDataArray),this.frequencyDataArray}},{key:"getWaveform",value:function(){return this.analyserNode.getByteTimeDomainData(this.timeDomainDataArray),this.timeDomainDataArray}},{key:"getFrequency",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0,i=this.getSpectrum();if(void 0!==e){for(var o=t;o<=e;o++)n+=i[o];return n/(e-t+1)}return i[t]}},{key:"createKick",value:function(t){var e=t.frequency,n=t.threshold,i=t.decay,o=t.onKick,s=t.offKick,r=new a({frequency:e,threshold:n,decay:i,onKick:o,offKick:s});return this._kicks.push(r),r}},{key:"createBeat",value:function(t){var e=t.factor,n=t.onBeat,i=new r({factor:e,onBeat:n});return this._beats.push(i),i}},{key:"onUpdate",value:function(){this.req=requestAnimationFrame(this._onUpdate);for(var t in this._sections)this._sections[t].condition()&&this._sections[t].callback.call(this);var e=this.getSpectrum();for(var n in this._kicks)this._kicks[n].calc(e);var i=Math.max(0,this.time-this._offsetTime);for(var o in this._beats)this._beats[o].calc(i,this._beatDuration);this.debug&&this.debug.draw()}},{key:"onEnded",value:function(){this.stop()}},{key:"progress",get:function(){return this._progress}},{key:"isLoaded",get:function(){return this._isLoaded}},{key:"duration",get:function(){return this._isLoaded?this._buffer.duration:0}},{key:"time",get:function(){return this.isPlaying?this.ctx.currentTime-this._startTime:this._pauseTime-this._startTime}},{key:"volume",set:function(t){this.gainNode.gain.value=t},get:function(){return this.gainNode.gain.value}},{key:"isPlaying",get:function(){return this._isPlaying}},{key:"beatDuration",get:function(){return this._beatDuration}}]),t}();e.default=s;var a=function(){function t(e){var n=e.frequency,o=e.threshold,s=e.decay,a=e.onKick,r=e.offKick;i(this,t),this.frequency=void 0!==n?n:[0,10],this.threshold=void 0!==o?o:.3,this.decay=void 0!==s?s:.02,this.onKick=a,this.offKick=r,this.isOn=!1,this.isKick=!1,this.currentThreshold=this.threshold}return o(t,[{key:"on",value:function(){this.isOn=!0}},{key:"off",value:function(){this.isOn=!1}},{key:"set",value:function(t){var e=t.frequency,n=t.threshold,i=t.decay,o=t.onKick,s=t.offKick;this.frequency=void 0!==e?e:this.frequency,this.threshold=void 0!==n?n:this.threshold,this.decay=void 0!==i?i:this.decay,this.onKick=o||this.onKick,this.offKick=s||this.offKick}},{key:"calc",value:function(t){if(this.isOn){var e=this.maxAmplitude(t,this.frequency);e>=this.currentThreshold&&e>=this.threshold?(this.currentThreshold=e,this.onKick&&this.onKick(e),this.isKick=!0):(this.offKick&&this.offKick(e),this.currentThreshold-=this.decay,this.isKick=!1)}}},{key:"maxAmplitude",value:function(t,e){var n=0;if(!e.length)return e<t.length?t[~~e]:null;for(var i=e[0],o=e[1];i<=o;i++)t[i]>n&&(n=t[i]);return n}}]),t}(),r=function(){function t(e){var n=e.factor,o=e.onBeat;i(this,t),this.factor=void 0!==n?n:1,this.onBeat=o,this.isOn=!1,this.currentTime=0}return o(t,[{key:"on",value:function(){this.isOn=!0}},{key:"off",value:function(){this.isOn=!1}},{key:"set",value:function(t){var e=t.factor,n=t.onBeat;this.factor=void 0!==e?e:this.factor,this.onBeat=n||this.onBeat}},{key:"calc",value:function(t,e){if(0!=t){var n=e*this.factor;t>=this.currentTime+n&&(this.isOn&&this.onBeat&&this.onBeat(),this.currentTime+=n)}}}]),t}(),c=function(){function t(e){i(this,t),this.sound=e,this.canvas=document.createElement("canvas"),this.canvas.width=512,this.canvas.height=300,this.canvas.style.position="absolute",this.canvas.style.bottom=0,this.canvas.style.left=0,this.canvas.style.zIndex=3,document.body.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),window.addEventListener("resize",this.resize.bind(this),!1),this.resize()}return o(t,[{key:"resize",value:function(){this.canvas.width=window.innerWidth}},{key:"draw",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.beginPath(),this.ctx.rect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="rgba(0,0,0,0.4)",this.ctx.fill(),this.ctx.strokeStyle="#a1a1a1",this.ctx.stroke(),this.ctx.beginPath();for(var t=this.sound.getSpectrum(),e=null,n=t.length,i=this.canvas.width/n,o=this.canvas.height-10,s=0;s<n;s++)e=t[s]/256,this.ctx.rect(s*i,o-o*e,i/2,o*e);this.ctx.fillStyle="#ffffff",this.ctx.fill(),this.ctx.beginPath(),this.ctx.font="10px Arial",this.ctx.textBaseline="middle",this.ctx.textAlign="left";for(var a=0,r=n;a<r;a++)a%10==0&&(this.ctx.rect(a*i,o,i/2,10),this.ctx.fillText(a,a*i+4,o+5));this.ctx.fillStyle="#ffffff",this.ctx.fill();for(var c=this.sound._kicks,h=null,u=c.length,l=null,d=null,p=0,m=u;p<m;p++)h=c[p],h.isOn&&(l=h.frequency.length?h.frequency[0]:h.frequency,d=h.frequency.length?h.frequency[1]-h.frequency[0]+1:1,this.ctx.beginPath(),this.ctx.rect(l*i,o-o*(h.threshold/256),d*i-.5*i,2),this.ctx.rect(l*i,o-o*(h.currentThreshold/256),d*i-.5*i,5),this.ctx.fillStyle=h.isKick?"#00ff00":"#ff0000",this.ctx.fill());this.ctx.beginPath();for(var f=this.sound.getWaveform(),g=null,y=f.length,v=this.canvas.width/y,b=this.canvas.height-10,w=0;w<y;w++)g=f[w]/256,0==w?this.ctx.moveTo(w*v,b*g):this.ctx.lineTo(w*v,b*g);this.ctx.strokeStyle="#0000ff",this.ctx.stroke(),this.ctx.beginPath(),this.ctx.textAlign="right",this.ctx.textBaseline="top",this.ctx.font="15px Arial",this.ctx.fillStyle="#ffffff",this.ctx.fillText(Math.round(10*this.sound.time)/10+" / "+Math.round(10*this.sound.duration)/10,this.canvas.width-5,5),this.ctx.beginPath();for(var k=this.sound._sections,C=null,E=k.length,x="",P=0,A=E;P<A;P++)C=k[P],C.condition()&&(x+=C.label+" - ");x.length>0&&(x=x.substr(0,x.length-3)),this.ctx.fillText(x,this.canvas.width-5,25),this.ctx.fill()}}]),t}()},function(t,e,n){"use strict";(function(t){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function e(i){var o=this,s=i.app,a=i.columnsNb;n(this,e),this.app=s,this.columnsNb=void 0!==a?a:10,this.columns=[],this.lastCol,this.columnWidth=6,this.columnY=-5,this.colIsRight=!0,this.maxScaleCol=400,this.spaceCol=10,this.columnsNb=this.app.ground.groundDepth/(this.spaceCol+this.columnWidth),this.columnGroup=new t.Group,this.spectrum,this.spectrumValue=null,this.spectrumLength,this.spectrumStep,this.audioFreqs=new Float32Array(256),"lane"==appConfig.columns.position?this.columnsNb=tools.isOdd(this.columnsNb)?this.columnsNb+1:this.columnsNb:"random"==appConfig.columns.position&&(this.columnsNb*=2),this.startPosColArc=function(t){return-o.app.ground.groundDepth-t*(o.spaceCol+o.columnWidth)},this.geometry=new t.CylinderGeometry(this.columnWidth,this.columnWidth,1,7),this.material=new t.MeshBasicMaterial({color:this.app.firstColor,emissive:this.app.firstColor,reflectivity:0,shininess:0}),this.outlineMaterial1=new t.MeshBasicMaterial({color:this.app.secondColor,side:t.BackSide});for(var r=0;r<this.columnsNb;r++)this.columns[r]=new t.Mesh(this.geometry,this.material),this.columns[r].position.y=this.columnY,this.columns[r].outline=new t.Mesh(this.geometry,this.outlineMaterial1),this.columns[r].tween={},this.columns[r].targetScale=400,"lane"==appConfig.columns.position?this.toLane(r):"arc"==appConfig.columns.position?this.toArc(r):this.toRandom(r),this.columns[r].outline.position.copy(this.columns[r].position),this.columns[r].outline.rotation.copy(this.columns[r].rotation),this.columns[r].outline.scale.multiplyScalar(1.1),this.columns[r].outline.scale.y=this.columns[r].scale.y+.5,this.columnGroup.add(this.columns[r].outline),this.columnGroup.add(this.columns[r]);s.scene.add(this.columnGroup)}return i(e,[{key:"animate",value:function(){this.audioSpectrum();for(var t=0;t<this.columns.length;t++)this.spectrumValue=this.spectrum[t*this.step],this.audioFreqs[t]+=.1*(this.spectrumValue-this.audioFreqs[t]),this.columns[t].position.z+=app.maxSpeed,this.columns[t].outline.position.z=this.columns[t].position.z,appConfig.columns.isChanging?(this.columns[t].scale.y*=.95,this.columns[t].outline.scale.y=this.columns[t].scale.y):("lane"==appConfig.columns.position?(this.updateLane(t),this.resetLane(t)):"arc"==appConfig.columns.position?(this.updateArc(t),this.resetArc(t)):(this.updateRandom(t),this.resetRandom(t)),void 0==this.lastCol&&(this.lastCol=this.columns[t]),void 0!==this.lastCol&&this.columns[t].position.z<this.lastCol.position.z&&(this.lastCol=this.columns[t]));if(appConfig.columns.isChanging&&this.lastCol.scale.y<=5){var t=0;for(this.columns.length;t<this.columns.length;t++)"random"==appConfig.columns.position&&this.toRandom(t),"arc"==appConfig.columns.position&&this.toArc(t),"lane"==appConfig.columns.position&&this.toLane(t),this.columns[t].outline.position.copy(this.columns[t].position),this.columns[t].outline.rotation.copy(this.columns[t].rotation);appConfig.columns.isChanging=!1}}},{key:"toLane",value:function(t){this.colIsRight=!this.colIsRight,this.columns[t].position.x=this.colIsRight?this.app.ground.width/8:-this.app.ground.width/8,this.columns[t].position.z=this.colIsRight?-((t-1)*(this.spaceCol+this.columnWidth)+this.app.ground.groundDepth):-(t*(this.spaceCol+this.columnWidth)+this.app.ground.groundDepth),this.columns[t].rotation.z=0,this.columns[t].scale.y=37,this.columns[t].outline.scale.y=this.columns[t].scale.y,this.columns[t].outline.position.copy(this.columns[t].position)}},{key:"updateLane",value:function(t){this.colIsRight=!this.colIsRight;var e=this.colIsRight?this.audioFreqs[t-1]:this.audioFreqs[t];this.columns[t].scale.y=20+.5*e,this.columns[t].outline.scale.y=this.columns[t].scale.y}},{key:"resetLane",value:function(t){this.columns[t].position.z>0&&(this.columns[t].position.z=-this.app.ground.groundDepth-this.spaceCol,this.columns[t].position.y=-5,this.columns[t].rotation.z=0,this.columns[t].outline.position.copy(this.columns[t].position))}},{key:"toArc",value:function(t){this.colIsRight=!this.colIsRight,this.columns[t].position.x=this.colIsRight?this.app.ground.width/6:-this.app.ground.width/6,this.columns[t].rotation.z=this.colIsRight?.5:-.5,this.columns[t].position.z=this.startPosColArc(t),this.columns[t].scale.y=this.maxScaleCol,this.columns[t].outline.scale.y=this.columns[t].scale.y}},{key:"updateArc",value:function(t){var e=this.columns[t].position.x;this.columns[t].position.z>-this.app.ground.groundDepth/1.7&&this.columns[t].position.y>=-this.maxScaleCol&&this.columns[t].position.x&&(this.columns[t].position.y-=appConfig.columns.speed,this.columns[t].position.x+=e>0?appConfig.columns.speed/2:-appConfig.columns.speed/2,this.columns[t].outline.position.copy(this.columns[t].position));var n=this.colIsRight?this.audioFreqs[t-1]:this.audioFreqs[t];this.columns[t].scale.y=n+this.maxScaleCol,this.columns[t].outline.scale.y=this.columns[t].scale.y}},{key:"resetArc",value:function(t){var e=this.columns[t].position.x;this.columns[t].position.z>0&&(this.columns[t].position.z=-this.app.ground.groundDepth,this.columns[t].position.x=e>0?-this.app.ground.width/6:this.app.ground.width/6,this.columns[t].position.y=-5,this.columns[t].rotation.z=-1*this.columns[t].rotation.z,this.columns[t].outline.position.copy(this.columns[t].position),this.columns[t].outline.rotation.copy(this.columns[t].rotation))}},{key:"toRandom",value:function(t){this.columns[t].position.z=0,this.columns[t].position.x=1===Math.floor(2*Math.random())?this.app.ground.width/8+Math.random()*this.app.ground.width/5:-(this.app.ground.width/8+Math.random()*this.app.ground.width/5),this.columns[t].position.y=0,this.columns[t].rotation.z=.6*Math.random(),this.columns[t].scale.y=0}},{key:"updateRandom",value:function(t){if(this.columns[t].scale.y>=this.maxScaleCol){var e=1.1*this.audioFreqs[t]+this.maxScaleCol;this.columns[t].scale.y+=.13*(e-this.columns[t].scale.y),this.columns[t].outline.scale.y=this.columns[t].scale.y}}},{key:"resetRandom",value:function(t){this.columns[t].position.z>0&&(this.columns[t].position.z=-10-Math.random()*(appConfig.far+50),this.columns[t].scale.y=0,this.columns[t].outline.scale.y=this.columns[t].scale.y)}},{key:"randSpawn",value:function(){for(var t=0;t<this.columns.length;t++){var e=this.maxScaleCol;if(this.columns[t].scale.y<1&&this.columns[t].position.z<0){var n={scale:0,mesh:this.columns[t]},i=function(){this._object.mesh.scale.y=this._object.scale,this._object.mesh.outline.scale.y=this._object.mesh.scale.y};new TWEEN.Tween(n).to({scale:e},600).onUpdate(i).easing(TWEEN.Easing.Exponential.Out).start()}}}},{key:"changePosition",value:function(){appConfig.columns.isChanging=!0;var t=appConfig.columns.positions.shift();appConfig.columns.positions.push(t),appConfig.columns.position=appConfig.columns.positions[0]}},{key:"audioSpectrum",value:function(){this.spectrum=this.app.sound.getSpectrum().slice(10,60),this.spectrumLength=this.spectrum.length,this.step=Math.round(this.spectrumLength/this.columns.length)}}]),e}();e.default=o}).call(e,n(0))},function(t,e,n){"use strict";(function(t){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function e(i){var o=i.app,s=i.width,a=i.groundDepth,r=i.groundSegments;n(this,e),this.app=o,this.width=void 0!==s?s:600,this.groundDepth=void 0!==a?a:400,this.groundSegments=void 0!==r?r:70,this.curveIntensity=6.5,this.groundSpaceReduce=1*this.curveIntensity,this.grounds=[],this.groundGeometry=new t.PlaneGeometry(this.width,this.groundDepth,this.groundSegments,this.groundSegments);var c=new t.MeshLambertMaterial({color:this.app.secondColor,emissive:this.app.secondColor,side:t.DoubleSide});this.ground=new t.Mesh(this.groundGeometry,c),this.ground.material.side=t.DoubleSide,this.ground.rotation.x=tools.de2ra(90),this.grounds[0]=this.ground,this.grounds[1]=this.ground.clone(),this.grounds[1].geometry=this.ground.geometry.clone(),this.grounds[1].position.z=-this.ground.position.z-this.groundDepth+this.groundSpaceReduce,this.grounds[2]=this.ground.clone(),this.grounds[2].geometry=this.ground.geometry.clone(),this.grounds[2].position.z=-this.ground.position.z-2*this.groundDepth+this.groundSpaceReduce,this.generateHills(),this.groundGroup=new t.Group,this.groundGroup.position.z=-this.groundDepth/2,this.groundGroup.position.y=-.9,this.groundGroup.position.x=0;for(var h=0;h<this.grounds.length;h++)this.groundGroup.add(this.grounds[h]);this.app.scene.add(this.groundGroup)}return i(e,[{key:"generateHills",value:function(){for(var t=0;t<this.grounds.length;t++)for(var e=0,n=this.grounds[t].geometry.vertices.length;e<n;e++){var i=this.grounds[t].geometry.vertices[e];i.z=2*this.app.snoise.noise2D(i.x/appConfig.noiseTextureSize,i.y/appConfig.noiseTextureSize),i.z-=Math.exp(Math.abs(i.x)/(this.width/2)*this.curveIntensity),(e<this.groundSegments||e>n-this.groundSegments)&&(this.grounds[t].geometry.vertices[e].z=2)}}},{key:"animate",value:function(){this.groundGeometry.verticesNeedUpdate=!0,this.groundGeometry.dynamic=!0;for(var t=0;t<this.grounds.length;t++)if(this.grounds[t].position.z+=app.maxSpeed,this.grounds[t].position.z>this.groundDepth){var e=0===t?2:t-1;this.grounds[t].position.z=this.grounds[e].position.z-this.groundDepth+this.groundSpaceReduce}}}]),e}();e.default=o}).call(e,n(0))},function(t,e,n){"use strict";(function(t){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function e(i){var o=i.app,s=i.dropsNb,a=i.rainSpeed;n(this,e),this.dropsNb=void 0!==s?s:400,this.rainSpeed=void 0!==a?a:5,this.rainSpeed*=.05,this.drops=[],this.rainGroup=new t.Group;for(var r=0;r<this.dropsNb;r++){var c=new t.BoxGeometry(.005,.2,.005),h=new t.MeshBasicMaterial({color:0,opacity:.12,transparent:!0});this.drops[r]=new t.Mesh(c,h),this.drops[r].position.x=5-10*Math.random(),this.drops[r].position.y=5-Math.floor(20*Math.random()),this.drops[r].position.z=5-10*Math.random(),this.drops[r].rotation.z=0,this.rainGroup.add(this.drops[r])}this.rainGroup.rotation.x=-.7,this.rainGroup.position.x=0,this.rainGroup.position.y=0,this.rainGroup.position.z=-1.7,o.scene.add(this.rainGroup)}return i(e,[{key:"animate",value:function(){for(var t=0;t<this.drops.length;t++)this.drops[t].position.y-=this.rainSpeed,this.drops[t].position.y<-2&&(this.drops[t].position.y=15+20*Math.random())}}]),e}();e.default=o}).call(e,n(0))}],[7]);
